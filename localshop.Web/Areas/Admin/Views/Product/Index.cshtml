@using localshop.Core.Common

@model ListProductViewModel

@{
    ViewBag.Title = "Index";
}

@section topbar {
    @Html.Action("topbar", "nav", new { header = NavigationHeader.ProductIndex })
}

@section thirdPartyCss {
    <!-- Datatables Css -->
    <link href="~/Assets/admin/libs/datatables/dataTables.bootstrap4.css" rel="stylesheet" type="text/css" />
    <link href="~/Assets/admin/libs/datatables/responsive.bootstrap4.css" rel="stylesheet" type="text/css" />
    <link href="~/Assets/admin/libs/datatables/buttons.bootstrap4.css" rel="stylesheet" type="text/css" />
    <link href="~/Assets/admin/libs/datatables/select.bootstrap4.css" rel="stylesheet" type="text/css" />
    <link href="~/Assets/admin/libs/sweetalert2/sweetalert2.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Assets/admin/libs/toastr/toastr.min.css" rel="stylesheet" type="text/css" />
}

@section thirdPartyJs {
    <!-- Datatables -->
    <script src="~/Assets/admin/libs/datatables/jquery.dataTables.min.js"></script>
    <script src="~/Assets/admin/libs/datatables/dataTables.bootstrap4.js"></script>
    <script src="~/Assets/admin/libs/datatables/dataTables.responsive.min.js"></script>
    <script src="~/Assets/admin/libs/datatables/responsive.bootstrap4.min.js"></script>
    <script src="~/Assets/admin/libs/datatables/dataTables.buttons.min.js"></script>
    <script src="~/Assets/admin/libs/datatables/buttons.bootstrap4.min.js"></script>
    <script src="~/Assets/admin/libs/datatables/buttons.html5.min.js"></script>
    <script src="~/Assets/admin/libs/datatables/buttons.flash.min.js"></script>
    <script src="~/Assets/admin/libs/datatables/buttons.print.min.js"></script>
    <script src="~/Assets/admin/libs/datatables/dataTables.keyTable.min.js"></script>
    <script src="~/Assets/admin/libs/datatables/dataTables.select.min.js"></script>
    <script src="~/Assets/admin/libs/pdfmake/pdfmake.min.js"></script>
    <script src="~/Assets/admin/libs/pdfmake/vfs_fonts.js"></script>
    <script src="~/Assets/admin/libs/sweetalert2/sweetalert2.min.js"></script>
    <script src="~/Assets/admin/libs/toastr/toastr.min.js"></script>

    <!-- Datatables init -->
    <script src="~/Assets/admin/js/pages/datatables.init.js"></script>
    <script src="~/Assets/admin/js/pages/sweet-alerts.init.js"></script>
    <script src="~/Assets/admin/js/pages/toastr.init.js"></script>

    <!-- Controller -->
    <script src="~/Assets/admin/js/controllers/product/index.js"></script>

    <script>
         $(document).ready(function () {
            toastr.options = {
                "closeButton": false,
                "debug": false,
                "newestOnTop": false,
                "progressBar": false,
                "positionClass": "toast-bottom-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "2000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            if ('@TempData["SaveSuccess"]' == "Success") {
                toastr['success']("Saved!");
            }
        });
    </script>
}

<div class="row">
    <div class="col-12">
        <div class="card-box overflow-auto">
            <table id="datatable" class="table table-bordered table-striped nowrap">
                <thead>
                    <tr>
                        <th>Product name</th>
                        <th>SKU</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Status</th>
                        <th>Date Added/Modified</th>
                        <th>Action</th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var product in Model.Products)
                    {
                        var productCategory = Model.Categories.FirstOrDefault(c => c.Id == product.CategoryId);
                        var productStatus = Model.Statuses.FirstOrDefault(s => s.Id == product.StatusId);

                        <tr data-product-id=@product.Id>
                            <td>
                                <img class="mr-1" src="@(product.Images.Count>0?product.Images.First():"/Assets/admin/images/no-image.png")" alt="image" height="60" width="60" style="object-fit:scale-down;">
                                <p class="d-inline-block align-middle mb-0">
                                    <a href="#" class="d-inline-block align-middle mb-0 product-name" title="@product.Name">@product.Name.Truncate(40)</a>
                                    <br />
                                    <span class="text-muted font-13">@(productCategory != null ? productCategory.Name : "")</span>
                                </p>
                            </td>
                            <td>@product.Sku</td>
                            <td>
                                @if (product.DiscountPrice != null)
                                {
                                    <strong class="text-danger">$@product.DiscountPrice</strong>
                                    <br />
                                    <del class="text-muted">$@product.Price</del>
                                }
                                else
                                {
                                    <strong>$@product.Price</strong>
                                }
                            </td>
                            <td>@product.Quantity</td>
                            <td>
                                @if (productStatus != null)
                                {
                                    if (productStatus.Name == StatusNames.InStock)
                                    {
                                        <span class="badge badge-success">@productStatus.Name</span>
                                    }

                                    if (productStatus.Name == StatusNames.OutOfStock)
                                    {
                                        <span class="badge badge-warning">@productStatus.Name</span>
                                    }
                                }
                            </td>
                            <td>
                                <span>Added: @product.DateAdded.ToShortDateString()</span>
                                @if (product.DateModified != null)
                                {
                                    <br />
                                    <strong>Modified: @product.DateModified.Value.ToShortDateString()</strong>
                                }
                            </td>
                            <td class="text-center">
                                <a href="@Url.Action("edit", "product", new { id=product.Id })" class="btn btn-outline-primary btn-sm ls-product-edit"><i class="far fa-edit"></i></a>
                                <a href="javascript:void(0)" class="btn btn-outline-danger btn-sm ls-product-delete"><i class="far fa-trash-alt"></i></a>
                            </td>
                        </tr>
                    }
                    @*<tr>
                        <td>
                            <img class="mr-1" src="~/assets/admin/images/big/bg.jpg" alt="" height="60" width="60" style="object-fit:scale-down;">
                            <p class="d-inline-block align-middle mb-0">
                                <a href="" class="d-inline-block align-middle mb-0 product-name">Adidas Footboll</a>
                                <br />
                                <span class="text-muted font-13">Laptop</span>
                            </p>
                        </td>
                        <td>F123</td>
                        <td>
                            <strong class="text-danger">$120</strong>
                            <br />
                            <del class="text-muted">$200</del>
                        </td>
                        <td>20</td>
                        <td><span class="badge badge-success">In stock</span></td>
                        <td>12/12/2012</td>
                        <td class="text-center">
                            <a href="#" class="btn btn-outline-primary btn-sm"><i class="far fa-edit"></i></a>
                            <a href="#" class="btn btn-outline-danger btn-sm"><i class="far fa-trash-alt"></i></a>
                        </td>
                    </tr>*@
                </tbody>
            </table>
        </div>
    </div>
</div> <!-- end row -->